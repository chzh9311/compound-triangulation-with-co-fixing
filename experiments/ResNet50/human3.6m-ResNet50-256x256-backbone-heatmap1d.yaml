DATASET:
  NAME: human3.6m
  ROOT: /home/chenzhuo/data/h36m-fetch/processed
  LABELS: /home/chenzhuo/data/h36m-fetch/extra/human36m-multiview-labels-GTbboxes.npy
  MONOLABELS: /home/chenzhuo/Projects/DNN_3DHPE/Mine/DensityFieldPose/data/h36m/labels/human36m-monocular-labels-GTbboxes.npy
MODEL:
  STYLE: "pytorch"
  SOFTMAX_BETA: 100
  IMAGE_SIZE:
    - 256
    - 256
  NUM_JOINTS: 17
  NUM_BONES: 16
  INIT_WEIGHTS: True
  PRETRAINED: pretrained/pytorch/pose_mpii/pose_resnet_50_256x256.pth.tar
  BACKBONE_WEIGHTS: log/backbone/Training_heatmap1d_ResNet50/weights/best.pth

  # The method to regress density map:
  # 1. 'direct' means directly regress heatmap using simple regression module;
  # 2. 'heatmap2d' means output 2d heatmap and regress mathematically.
  # 3. 'heatmap1d' means output 1d heatmap and regress.
  # 4. 'offsetmap' refers to vector field that points to the vanishing point.
  # None for pure joint estimations.
  DENSITY_REG_METHOD: heatmap1d

  EXTRA:
    SIGMA: 2
    HEATMAP_SIZE:
      - 64
      - 64
    FINAL_CONV_KERNEL: 1
    DECONV_WITH_BIAS: False
    NUM_DECONV_LAYERS: 3
    NUM_DECONV_FILTERS:
      - 256
      - 256
      - 256
    NUM_DECONV_KERNELS:
      - 4
      - 4
      - 4
    NUM_LAYERS: 50

  DIRECT:
    # For direct
    NUM_REFINE: 2
    # For heatmap1d

  HEATMAP2D:
    REG_METHOD: linear # linear or exp
    ALPHA: 0.001
    N_SAMPLES: 16
    OFFSET: 0.00001

  HEATMAP1D:
    DENSITY_SIZE: 64

  OFFSETMAP:
    FINAL_CONV_KERNEL: 1
    DECONV_WITH_BIAS: False
    NUM_DECONV_LAYERS: 3
    NUM_DECONV_FILTERS:
      - 512
      - 512
      - 512
    NUM_DECONV_KERNELS:
      - 4
      - 4
      - 4


TRAIN:
  IS_PRETRAIN: True
  BATCH_SIZE: 128
  DATA_PARALLEL: True
  LEARNING_RATE: 0.00001
  SHUFFLE: True
  LOSS_WEIGHT:
    - 1
    - 0.01
  NUM_WORKERS: 16
  NUM_EPOCHS: 20
  CONTINUE: True
  CHECKPOINT: log/backbone/Training_heatmap1d_ResNet50/weights/checkpoint_epoch9_loss0.000622.pkl

TEST:
  BATCH_SIZE: 128
  SHUFFLE: True
  NUM_WORKERS: 8
